<CodeEditorModel xmlns="http://schemas.datacontract.org/2004/07/Omron.Cxap.Modules.DeviceHmi.CodeEditor.Core" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><CodingLanguageName>VBNET</CodingLanguageName><HiddenFooter>&#xD;
End Class</HiddenFooter><HiddenHeader>Partial Public Class Export_recipe&#xD;
</HiddenHeader><Text>'**********************************************************************&#xD;
'* Omron標準IAG&#xD;
'*作成日：2014/6/25&#xD;
'*作成者：Omron&#xD;
'*&#xD;
'*「レシピエクスポートIAG」&#xD;
'*レシピビューワで選択されたテンプレートを&#xD;
'*PathAndFileNameで指定したファイルにエクスポートする&#xD;
'*&#xD;
'**********************************************************************&#xD;
&#xD;
Sub RecipeExport&#xD;
	'**********************************************************************	&#xD;
	'内部変数宣言&#xD;
	'**********************************************************************&#xD;
	Dim i As Integer&#xD;
	Dim WriteString As String = ""&#xD;
	Dim TempName As String = GetSelectedRecipeTemplate(_HMI_CurrentPage,RecipeObjName)&#xD;
	Dim InstanceNameArray() As String　= GetRecipeNames(TempName)&#xD;
	Dim IngredientsNameArray() As String　= GetRecipeIngredientNames(TempName)&#xD;
&#xD;
	'取得失敗時処理&#xD;
	If InstanceNameArray.Length &lt;= 0 Or IngredientsNameArray.Length &lt;= 0 Then&#xD;
		Exit Sub&#xD;
	End If&#xD;
			&#xD;
	'**********************************************************************	&#xD;
	'ファイル先頭行（ヘッダ）部書込み準備処理&#xD;
	'**********************************************************************	&#xD;
	For i = 0 To IngredientsNameArray.Length - 1 Step 1&#xD;
		WriteString = WriteString + IngredientsNameArray(i)&#xD;
		If i &lt; IngredientsNameArray.Length - 1 Then&#xD;
			WriteString = WriteString + ","&#xD;
		End If&#xD;
	Next&#xD;
&#xD;
	'**********************************************************************	&#xD;
	'ファイル生成&#xD;
	'**********************************************************************	&#xD;
	Try&#xD;
		Using csvWriter As System.IO.StreamWriter = New System.IO.StreamWriter(PathAndFileName)&#xD;
		'ファイル生成成功時処理&#xD;
			'ヘッダ部書込み処理&#xD;
			csvWriter.WriteLine("Name," + WriteString)&#xD;
			Dim Ins As Integer&#xD;
			Dim Ing As Integer&#xD;
			Dim Obj As Object&#xD;
			Dim WriteValue As String&#xD;
			'各データ書込み処理&#xD;
			For Ins = 0 To InstanceNameArray.Length - 1 Step 1&#xD;
				WriteValue = ""&#xD;
				For Ing = 0 To IngredientsNameArray.Length - 1 Step 1&#xD;
					Obj = GetRecipeIngredientValue(TempName,InstanceNameArray(Ins),IngredientsNameArray(Ing))&#xD;
					WriteValue = WriteValue + Obj.ToString&#xD;
					If Ing &lt; IngredientsNameArray.Length - 1 Then&#xD;
							WriteValue = WriteValue + ","&#xD;
					End If&#xD;
				Next					&#xD;
				csvWriter.WriteLine(InstanceNameArray(Ins) + "," +  WriteValue)&#xD;
			Next&#xD;
		End Using&#xD;
	'ファイル生成失敗時処理	&#xD;
	Catch ex As System.IO.IOException&#xD;
		Exit Sub&#xD;
	End Try&#xD;
End Sub</Text></CodeEditorModel>