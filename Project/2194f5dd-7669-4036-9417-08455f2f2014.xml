<StructuredTextModel xmlns="http://schemas.datacontract.org/2004/07/Omron.Cxap.Modules.StructuredText.Core" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><Text>IF (Enable) THEN&#xD;
	// Scale the encoder raw data in order to get a an angle&#xD;
	Angle := ScaleTrans(SclIN:=ULINT_TO_REAL(IN_Enc_Pos),&#xD;
							   					 X0:=TO_REAL(Encoder_Info.Homing_Data),&#xD;
							 					 X1:=TO_REAL(Encoder_Info.Homing_Data)+HMI_Feeder_Data_Retained.Straightner_Enc_Raw_Max,&#xD;
			   		  							 Y0:=TO_REAL(0.0), &#xD;
					  							 Y1:=TO_REAL(360.0));&#xD;
	// Make sure we do not use 90 as 90 will return bad values&#xD;
	IF (Angle = 90) THEN&#xD;
		Angle := 89;&#xD;
	END_IF;&#xD;
	&#xD;
	// Calculate eccentricity based on the stroke&#xD;
	Eccentricity := HMI_Feeder_Data_Retained.Straightner_Enc_Max_Val/2;&#xD;
	// Calculate the current value using COS&#xD;
	Current_Value := Eccentricity*COS(DegToRad(TO_LREAL(Angle)));&#xD;
&#xD;
	&#xD;
	// Determine if, and how far, we are from the setpoint - raise an alarm if we are too far off&#xD;
	Enc_Deviation(Current_Value:=TO_LREAL(Current_Value), Always_True:=TRUE, &#xD;
							 Setpoint_Value:=Setpoint,&#xD;
							 Min_Value:=HMI_Feeder_Data_Retained.Straightner_Enc_Min_Val,&#xD;
							 Max_Value:=HMI_Feeder_Data_Retained.Straightner_Enc_Max_Val,&#xD;
							 Allowed_Deviation:=Fault_Tolerance,&#xD;
							 Deviation=&gt;Deviation_Fault,&#xD;
							 Current_Deviation=&gt;Deviation_Value);&#xD;
	&#xD;
ELSE&#xD;
	// Set alarm to false if we do not straightner encoders&#xD;
	Deviation_Fault := FALSE;&#xD;
END_IF;</Text></StructuredTextModel>